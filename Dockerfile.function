FROM nvcr.io/nvidia/pytorch:25.04-py3

# Set working directory
WORKDIR /workspace

RUN pip install --no-cache-dir transformers>=4.41.0 datasets>=2.19.0 huggingface_hub[hf_xet] peft bitsandbytes accelerate

COPY fixed-scripts/function-finetune-fixed.py .

COPY ./glaive_fc_v2 /processed_datasets/glaive_fc_v2/

# No CMD needed, will be launched by torchrun via sbatch
RUN ls -la /workspace/

ENV TRANSFORMERS_NO_ADVISORY_WARNINGS=1
